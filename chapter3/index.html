<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>3 - Set-up the design · BAWJ</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><a href="../"><img class="logo" src="../assets/logo.png" alt="BAWJ logo"/></a><h1>BAWJ</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Business Applications with Julia</a></li><li><a class="toctext" href="../chapter1/">1 - Intro Notebook</a></li><li><a class="toctext" href="../chapter2/">2 - Overview Julia</a></li><li class="current"><a class="toctext" href>3 - Set-up the design</a><ul class="internal"><li><a class="toctext" href="#A-procedure-as-a-starting-point-1">A procedure as a starting point</a></li><li><a class="toctext" href="#Domain-Driven-Design-and-Onion-Architecture-1">Domain Driven Design and Onion Architecture</a></li><li><a class="toctext" href="#A-review-of-the-procedure-Invoicing-1">A review of the procedure Invoicing</a></li><li><a class="toctext" href="#The-design-1">The design</a></li></ul></li><li><a class="toctext" href="../chapter4/">4 - Implementing the design</a></li><li><a class="toctext" href="../chapter5/">5 - Writing test software</a></li><li><a class="toctext" href="../chapter6/">6 - Creating the modules</a></li><li><a class="toctext" href="../chapter7/">7 - Documenting the modules</a></li><li><a class="toctext" href="../chapter8/">8 - Creating our microservices</a></li><li><a class="toctext" href="../chapter9/">9 - Running the containers</a></li><li><a class="toctext" href="../appendix/">Appendix</a></li><li><a class="toctext" href="../references/">References</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>3 - Set-up the design</a></li></ul><a class="edit-page" href="https://github.com/rbontekoe/BAWJ/blob/master/docs/src/chapter3.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>3 - Set-up the design</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Set-up-the-design-1" href="#Set-up-the-design-1">3 - Set-up the design</a></h1><h3><a class="nav-anchor" id="What-you-will-learn-1" href="#What-you-will-learn-1">What you will learn</a></h3><ul><li><a href="#Set-up-the-design-1">3 - Set-up the design</a></li><ul><li><a href="#A-procedure-as-a-starting-point-1">A procedure as a starting point</a></li><li><a href="#Domain-Driven-Design-and-Onion-Architecture-1">Domain Driven Design and Onion Architecture</a></li><li><a href="#A-review-of-the-procedure-Invoicing-1">A review of the procedure Invoicing</a></li><li><a href="#The-design-1">The design</a></li></ul></ul><p>We start with an procedure <code>Invoicing</code> we want to automate with Julia. Next, we will look at the requirements set by domain driven design. We end with the <code>design</code> we will implement.</p><h2><a class="nav-anchor" id="A-procedure-as-a-starting-point-1" href="#A-procedure-as-a-starting-point-1">A procedure as a starting point</a></h2><p>In 1994 we were delivering Lotus Notes instructor-led training in the Netherlands. We became ISO-9001 certified one year later. ISO is short for the International Organization for Standardization. A part of ISO is the section procedures.</p><p>A procedure describes a workflow. It specifies the activities to be carried out by people or machines and the resources that are required to produce a result.</p><p>An input triggers a process. Every action creates an output, which can be data, a product, or a service.</p><p>The example I use in the course is the procedure <code>Invoicing</code>.</p><h3><a class="nav-anchor" id="The-course-example-1" href="#The-course-example-1">The course example</a></h3><p>In 1998 we rewrote our procedures as a table. Every row represents an action. Next to the activities are the columns with roles involved with the work. We used the RASCI notation for the kind of task of a role:</p><table><tr><th style="text-align: left">Abbr</th><th style="text-align: left">Meaning</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left">R</td><td style="text-align: left">Responsible</td><td style="text-align: left">The person who is responsible for the execution of the activity.</td></tr><tr><td style="text-align: left">A</td><td style="text-align: left">Approves</td><td style="text-align: left">The person who approves the result before going to the next step.</td></tr><tr><td style="text-align: left">S</td><td style="text-align: left">Supports</td><td style="text-align: left">The members of the team.</td></tr><tr><td style="text-align: left">C</td><td style="text-align: left">Consults</td><td style="text-align: left">The person or entity to be consulted.</td></tr><tr><td style="text-align: left">I</td><td style="text-align: left">Informed</td><td style="text-align: left">The person to be notified about the result.</td></tr></table><hr/><p><strong>Procedure</strong>: Invoicing.</p><p><strong>Roles</strong>: OM = Office Manage, AOM = Assistant Office Manager.</p><p><strong>Input</strong>: A list of students who have shown up in the classroom.</p><table><tr><th style="text-align: left">Step</th><th style="text-align: left">Action</th><th style="text-align: left">AOM</th><th style="text-align: left">OM</th><th style="text-align: left">Output</th><th style="text-align: left">Tool</th><th style="text-align: left">Exception</th></tr><tr><td style="text-align: left">1</td><td style="text-align: left">Create an invoice per student</td><td style="text-align: left">R</td><td style="text-align: left">A</td><td style="text-align: left">Created and authorized invoices</td><td style="text-align: left">Order file</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">2</td><td style="text-align: left">Archive a copy of the invoice</td><td style="text-align: left">R</td><td style="text-align: left"></td><td style="text-align: left">Archived copy</td><td style="text-align: left">Accounts Receivable unpaid</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">3</td><td style="text-align: left">Send the invoice to the customer</td><td style="text-align: left">R</td><td style="text-align: left">I</td><td style="text-align: left">Invoice sent</td><td style="text-align: left"></td><td style="text-align: left"></td></tr><tr><td style="text-align: left">4</td><td style="text-align: left">Book the invoice</td><td style="text-align: left">R</td><td style="text-align: left">A</td><td style="text-align: left">Booked invoice</td><td style="text-align: left">General ledger</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">5</td><td style="text-align: left">Book the paid invoice</td><td style="text-align: left">R</td><td style="text-align: left">A</td><td style="text-align: left">Paid invoice</td><td style="text-align: left">Bank records, General ledger</td><td style="text-align: left"></td></tr><tr><td style="text-align: left">6</td><td style="text-align: left">Archive the paid invoice</td><td style="text-align: left">R</td><td style="text-align: left">I</td><td style="text-align: left">Archived invoice</td><td style="text-align: left">Accounts Receivable paid</td><td style="text-align: left"></td></tr></table><p><strong>End result</strong>: A paid invoice.</p><p>Let&#39;s see how we can automate the procedure with Julia. We tackle it with a technique of Domain Driven Design and the Onion architecture.</p><h2><a class="nav-anchor" id="Domain-Driven-Design-and-Onion-Architecture-1" href="#Domain-Driven-Design-and-Onion-Architecture-1">Domain Driven Design and Onion Architecture</a></h2><p>The trend nowadays is to create application consisting of different unambiguous and autonomous units, running in containers:</p><ul><li>You can quickly up and downscale containers based on the demand.</li><li>The software programmers can use their preferred programming language.</li><li>A unit is the owner of its data.</li></ul><p>The onion architecture lends itself perfectly to the domain-driven design pattern. If you look at the design like it&#39;s an onion, it&#39;s a core with peels around it. The base consists of Julia.</p><p>The next peel is the domain. There must be coherence between its elements. The experts in this field speak the same language and use the same terms. Most items here are objects. You only use constructs from the core.</p><p>The next layer is the API. Here you only use elements from the core and the domain. The API consists of the functions you use in your program.</p><p>The outer peel is the Infrastructure layer. Its the connection with the external world. It uses the elements in the domain and API and adapters to match differences in technologies.</p><p>An example is a REST request. If it is in JSON format, you have to convert it to a form you use in your software. After processing the inquiry, you turn it back to JSON. You can do so with adapters.</p><p>When you write you the software, you only use the functions in the API and the Infrastructure layers.</p><h2><a class="nav-anchor" id="A-review-of-the-procedure-Invoicing-1" href="#A-review-of-the-procedure-Invoicing-1">A review of the procedure Invoicing</a></h2><p>Looking at the <code>Invoicing</code> procedure, I see one domain or department, namely <code>Account Receivable</code>. It receives information from the process <code>Training Delivery</code>, which produces the list of students who have shown up in the classroom.</p><p>The resources are:</p><ul><li>Order file.</li><li>CSV list of bank records.</li><li>General Ledger.</li></ul><p>Owner of:</p><ul><li>Invoice</li></ul><p>Output</p><ul><li>Journalized unpaid invoices for General Ledger.</li><li>Journalized paid invoices for General Ledger.</li><li>Report of unpaid invoices.</li><li>Invoice as PDF.</li></ul><h3><a class="nav-anchor" id="Summarized-1" href="#Summarized-1">Summarized</a></h3><p>We send the invoices to the customer by email. We store copies of the invoices locally. We sent a journalized copies to General Ledger. We need:</p><ul><li>Dummy Order file module.</li><li>Dummy Training Delivery module.</li><li>Dummy General Ledger module.</li><li>Bank records file.</li></ul><h2><a class="nav-anchor" id="The-design-1" href="#The-design-1">The design</a></h2><h3><a class="nav-anchor" id="Domain-1" href="#Domain-1">Domain</a></h3><p>The domain objects are:</p><ul><li>Message.</li><li>Invoice.</li><li>InvoiceStatus: UNPAID, PAID.</li><li>JournalRecord.</li></ul><h3><a class="nav-anchor" id="API-Invoicing-1" href="#API-Invoicing-1">API Invoicing</a></h3><p>The API contains the methods (functions) of the module. The methods use only elements from the core or of the domain. An overview of what I think we need:</p><ul><li>createInvoice(id::String, company::Company, order::Order, students::Array(String, 1))::Invoice</li><li>updateInvoiceStatus(invoice::Invoice; status=&quot;PAID&quot;)::Invoice</li><li>createJournalRecord(invoice::Invoice)::JournalRecord</li><li>createJournalMessage(receiver::String, journalRecord::JournalRecord)::Message</li><li>readCSV(file::String)::DataFrame</li><li>findInvoice(df::DataFrame)::Invoice</li><li>reportUnpaidInvoices(db::SQLiteDB, table::String)::Dataframe</li></ul><p><a href="SQLite, tableName">DataFrames.jl</a>,  makes it easy to work with data.</p><h3><a class="nav-anchor" id="Infrastructure-1" href="#Infrastructure-1">Infrastructure</a></h3><p>The methods of Infrastructure layer:</p><ul><li>connect(path::String)::SQLiteDB</li><li>create(db::SQLiteDB, tableName::String, invoice::Invoice)</li><li>gather(db::SQLiteDB, tableName::String, selection::String)::DataFrame</li><li>createPDF(invoice::Invoice)::PDF</li><li>sendInvoice(invoice::Invoice, pdf::PDF)</li></ul><p><a href="https://juliadatabases.github.io/SQLite.jl/stable/">SQLite.jl</a> is the Julia package for SQLite, which we will use in the course. You can use it as an on-disk database file, but also as an in-memory database. The last option is ideal for testing.</p><p>I am thinking of Literate.jl as package to make PDFs.</p><p>ToDo:</p><ul><li>How to attach a PDF to an email?</li><li>How to send an email?</li></ul><footer><hr/><a class="previous" href="../chapter2/"><span class="direction">Previous</span><span class="title">2 - Overview Julia</span></a><a class="next" href="../chapter4/"><span class="direction">Next</span><span class="title">4 - Implementing the design</span></a></footer></article></body></html>
